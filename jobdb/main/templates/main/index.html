{% extends "main/base.html" %}

{% block content %}
  <div class="container-fluid p-0">
    <div class="row">
      <div class="col">
        <h2>Your Applications</h2>
        <a href="{% url 'queue_htmx' %}">Available postings: <b>{{ posting_queue.count }}</b></a>
        ({{ posting_queue_companies.count }} companies)<br />
        <a href="{% url 'application_htmx' %}">Your applications: <b>{{ your_apps.count }}</b></a>
        {% if unreported_apps_count %}
          (<a href="{% url 'application_htmx' %}?reported=false"><b>{{ unreported_apps_count }}</b> unreported</a>)
        {% endif %}
        <br />
        <br />
        <div class="container-fluid p-0">
          <div class="row">
            {% if posting_queue_companies.count %}
              <div class="col">
                Your top companies with available postings:
                <ul>
                  {% for c in posting_queue_companies|slice:"0:10" %}
                    {% if forloop.first %}
                    {% endif %}
                    <li>
                      <a href="{% url 'queue_htmx' %}?company={{ c.company__name }}">{{c.company__name}}</a>
                      ({{ c.count }} postings)</li>
                  {% endfor %}
                </ul>
                <br />
              </div>
            {% endif %}
            {% if your_apps_company_count.count %}
              <div class="col">
                Your top companies:
                <ul>
                  {% for c in your_apps_company_count|slice:"0:10" %}
                    {% if forloop.first %}
                    {% endif %}
                    <li>
                      <a href="{% url 'application_htmx' %}?company={{ c.company }}">{{c.company }}</a>
                      ({{ c.count }} applications)</li>
                  {% endfor %}
                </ul>
                <br />
              </div>
            {% endif %}
          </div>
        </div>
        <h2>Profile</h2>
        <a href="{% url 'user_profile_edit' %}">Edit user profile</a><br />
        Name: <b>{{ request.user.first_name }} {{ request.user.last_name }}</b><br />
        Email: {{ request.user.email|default:'(none)' }}<br />
        Phone: {{ request.user.phone|default:'(none)' }}<br />
        LinkedIn:
        {% if request.user.linkedin %}
          <a href="{{ request.user.linkedin }}" target="_blank" rel="noopener noreferrer">
            {{ request.user.linkedin }}
          </a>
        {% else %}
          (none)
        {% endif %}<br />
        <br />
      </div>
      <div class="col">
        <h2>Total Data</h2>
        <a href="{% url 'company_htmx' %}">Total companies: {{ company.count }}</a><br />
        <a href="{% url 'posting_htmx' %}">Total postings: {{ posting.count }}</a><br />
        <br />
        {% if leaderboard.count %}
          <h2>Leaderboard</h2>
          <ul>
            {% for u in leaderboard|slice:"0:10" %}
              {% if forloop.first %}
              {% endif %}
              <li>
                <b>{{ u.user__first_name|default:u.user__username }}</b>
                ({{ u.count }} applications)</li>
            {% endfor %}
          </ul>
        {% endif %}
      </div>
    </div>
  </div>
{% endblock %}
